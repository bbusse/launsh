#!/usr/bin/env zsh
#
# launsh - A collection of actions to drive daily computing
#
# SPDX-License-Identifier: BSD-3-Clause
# Author: BjÃ¶rn Busse <bj.rn@baerlin.eu>
#
# Dependencies: bash, curl, vju
# Individual modules may have further dependencies
#

LAUNSH_OPEN="${LAUNSH_OPEN:=xdg}"
LAUNSH_MODULE_PATH="${HOME}/.local/share/launsh/modules"
SCRIPT_NAME="$(basename "${0}")"
log_level=info

LAUNSH_SEND_NOTIFICATION=1

PATH=$PATH:${HOME}/.local/bin

# Source all .sh modules in the LAUNSH_MODULE_PATH directory
if [ -d "${LAUNSH_MODULE_PATH}" ]; then
    for module in "${LAUNSH_MODULE_PATH}"/*.sh; do
        [ -f "${module}" ] && source "${module}"
    done
fi

# Aliases setup
LAUNSH_ALIASES=(
    'lall="launsh allthethings"'
    'lo="launsh application"'
    'la="launsh auth onelogin"'
    'lcmd="launsh commands"'
    'ldc="launsh open-document Documents ~/Documents"'
    'ldw="launsh open-document Downloads ~/Downloads"'
    'gcs="launsh gh-copilot-suggest"'
    'gce="launsh gh-copilot-explain"'
    'lh="launsh histories"'
    'lpw="launsh pass"'
    'lpo="launsh podcasts ${DB_FILE_PODCASTS} podcasts episodes files"'
    'lrss="launsh rss ${DB_FILE_RSS} feeds entries"'
    'lssm="launsh ssm"'
    'ltv="launsh tv ðŸ“º https://raw.githubusercontent.com/jnk22/kodinerds-iptv/master/iptv/clean/clean_tv.m3u"'
    'li="launsh view-image "img" ~/Pictures"'
    'lw="launsh weather --width 1400 --height 1200 --monospace"'
)

function main() {
    local action
    action="${1}"

    case "${action}" in
        install-aliases) install_aliases ;;

        allthethings) allthethings "${@}" ;;
        help) show_help ;;
        application|open) lopen "${@}" ;;
        bluetooth) bt_toggle_connect_device "${@}" ;;
        commands) commands "${@}" ;;
        histories) histories "${@}" ;;
        mpv-mute|mpv-playlist-next|mpv-playlist-prev|mpv-start) mpv_command "${@}" ;;
        open-document|view-image) open_document "${@}" ;;
        pass) clip_pass "${@}" ;;
        podcasts) podcasts "${@}" ;;
        tv) tv "${@}" ;;
        rss) rss "${@}" ;;
        search-tube) search_tube "${@}" ;;
        search-web) search_web "${@}" ;;
        ssm) ssm "${@}" ;;
        vm-start) start_vm "${@}" ;;
        vm-connect) libvirt_vm_connect_vnc "${@}" ;;
        wifi-connect) wifi_connect "${@}" ;;
        wifi-scan) wifi_scan "${@}" ;;
        weather) weather "${@}" ;;
        maintenance) maintenance "${@}" ;;
        list-modules) list_modules ;;
        *)
            echo "Unknown action: ${action}"
            show_help
            ;;
    esac
}

main "${@}"
